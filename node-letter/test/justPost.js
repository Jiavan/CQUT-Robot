var superagent = require('superagent');
var cheerio = require('cheerio');
var mongo = require('./mongo');
var targetUrl = 'http://cs.cqut.edu.cn/DeanMail/MailList.aspx';
var pageId = process.argv.slice(2)[0];

var data = {
  __EVENTTARGET: 'ctl00$ContentPlaceHolder_main$DeanMailList1$GridView1',
  __EVENTARGUMENT: 'Page$' + pageId,
  __VIEWSTATE: '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',
  __EVENTVALIDATION: '/wEWDgLl/ZmHBQKJu/XvBwK98N3bCwLghKu0CALa9veJDALFn9WiAgKUo7JjAr/IkfQGAs6N/rQFAum63MkKAsjS2d0GAvP7v/cMAuCEp7QIAouthckNEqvkEuhaPQ1H+ZG5lpZo+w1sDlE='
};

if (parseInt(pageId, 10) === 1) {
  data = null;
}

superagent
  .post(targetUrl)
  .set({
    'Content-Type': 'application/x-www-form-urlencoded',
    'Cookie': 'ASP.NET_SessionId=yqknhl45hxw0t255d54r2u45',
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36'
  })
  .send(data)
  .end(function (err, res) {
   if (err) {
     console.log(err);
     return;
   }

   var $ = cheerio.load(res.text);
   $('#ctl00_ContentPlaceHolder_main_DeanMailList1_GridView1 [align="left"] a').each(function (idx, el) {
     $ = cheerio.load(el);
     console.log($('a').attr('title'));
   });
  });
